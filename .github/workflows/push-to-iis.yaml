name: Push to IIS Server

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on: iis
    steps:
      - name: Setup Node.js
        uses: actions/setup-node@v5
        with:
          node-version: '24'

      - name: Pull from GitHub
        env:
          PATH: "${{ env.PATH }};C:\\Program\ Files\\Git\\cmd;C:\\nvm4w\\nodejs"
        shell: cmd
        working-directory: C:\inetpub\TerraMagma
        run: |
          git config --global --add safe.directory C:/inetpub/TerraMagma
          git pull

      - name: NPM Install
        shell: cmd
        working-directory: C:\inetpub\TerraMagma
        run: |
          npm install

      - name: Build Project
        shell: cmd
        working-directory: C:\inetpub\TerraMagma
        run: |
          npm run build